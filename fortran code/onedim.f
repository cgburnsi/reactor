SUBROUTINE ONEDIM
C
C	*************************************************************
C	THIS SUBROUTINE CALCULATES THE 1-D INITIAL-DATA SURFACE
C	*************************************************************
C
	COMMON /AV/ IAV,CAV,NST,SMP,LSS,CTA,XMU,XLA,RKMU,QUT(81,21),QVT(81
   1,21),QPT(81,21)
	COMMON /ONESID/ UD(4),VD(4),PD(4),ROD(4)
	COMMON /SOLUTN/ U(81,21,2),V(81,21,2),P(8l,21,2),RO(81,2l,2)
	COMMON /CNTRLC/ LMAX,MMAX,NMAX,NPRINT,TCONV,FDT,GAMMA,RGAS,GAM1,GA
   1M2,L1,L2,L3,Ml,M2,DX,DY,DT,N,N1,N3,NASM,IVEL,ICHAR,N1D,LJET,JFLAG,
   2IERR,IUI,IUO,DXR,DYR,LD,MD,LMD1,LMD3,IB,RSTAR,RSTARS,NPLOT,G,PC,TC
   3,LC,PLOW,ROLOW
	COMMON /GEMTRYC/ NGEOM,XI,RI,XT,RT,XE,RE,RCI,RCT,ANGI,ANGE,XW(8l),
   1YW(8l),XWI(8l),YWI(8l),NXNY(8l),NWPTS,IINT,IDIF,LT,NDIM
	COMMON /GCB/ NGCB,XICB,RICB,XTCB,RTCB,XECB,RECB,RCICB,RCTCB,ANGICB
   1,ANGECB,XCB(8l),YCB(8l),XCBI(81),YCBI(8l),NXNYCB(8l),NCBPTS,IINTCB
   2,IDIFCB,LECB
	COMMON /BCC/ PT(21),TT(21),THETA(21),PE,MASSE,MASSI,MASST,THRUST,
   1NSTAG
	REAL MN3,NXNY,MASSI,MASST,NXNYCB,MASSE
		
	MN3=0.01
	IF (NID,EQ,-1,OR N1D,GT,2) MN3=2.0
	GRGAS=1.0/(RGAS*G)
	NXCK=0
	ACOEF=2.0/(GAMMA+1.0)
	BCOEF=(GAMMA-1.0)/(GAMMA+1.0)
	CCOEF=(GAMMA+1.0)/2.0/(GAMMA-1.0)
	IF (N1D,LT,0) GO TO 20
C
C	OVERALL LOOP
C		
	IF (NGCB,NE,0) GO TO 10
	RSTAR=RT
	RSTARS=RT*RT
	GO TO 20
10 	RSTAR=YW(LT)-YCB(LT)
	RSTARS=YW(LT)**2-YCB(LT)**2
20 	DO 130 L=1,LMAX
	IF (L,EQ,1,AND,N1D,EQ,-1) GO TO 130
	IF (L,EQ,1,AND,N1D,GT,2) GO TO 130
	X=XI+DX*(L-1)
	IF (N1D,LT,0) GO TO 50
	IF (NGCB,NE,0) GO TO 30
	IF (X,LT,XT) GO TO 50
	IF (X,GT,XT) GO TO 40
	MN3=1.0
	GO TO 100
30  IF (L,LT,LT) GO TO 50
	IF (L,GT,LT) GO TO 40
	MN3=1.0 
	GO TO 100
40  IF (NXCK,EQ,1) GO TO 50
	IF (NlD,EQ,1,OR,N1D,EQ,3) MN3=1.1
	IF (N1D,EQ,2,OR,NlD,EQ,4) MN3=0.9
	NXCK=1
50  IF (NDIM,EQ,1) GO TO 60
	RAD=YW(L)-YCB(L)
	ARATIO=RAD/RSTAR
	GO TO 70
60 	RADS=YW(L)**2-YCB(L)**2
	ARATIO=RADS/RSTARS
	C  
	C NEWTON-RAPHSON ITERATION LOOP
	C
70 	DO 90 ITER=1,20
	ABM = ACOEF + BCOEF * MN3**2
    ABMC = ABM**CCOEF
    FM = ABMC / MN3 - ARATIO
    FPM = ABMC * (2.0 * BCOEF * CCOEF/ABM-1.0/MN3**2)
    OMN3 = MN3
    MN3 = OMN3 - FM/FPM
	IF (MN3,GT,1.0,AND,OMN3,LT,1.0) MN3=0.99
	IF (MN3,LT,1.0,AND,OMN3,GT,1.0) MN3=1.01
	IF (MN3,GE,000) GO TO 80
	MN3=-MN3
	GO TO 90
80	IF (ABS(MN3-OMN3)/OMN3,LE,0.0005) GO TO 100
90 	CONTINUE
	PRINT 140, L
C
C	Fill IN 2-D ARRAYS LOOP
C
100 DEM = 1.0 + GAM2 * MN3 * MN3
    DEMP = DEM**GAM1
    DNXNY = (NXNY(L) - NXNYCB(L)) / M1
	DO 120 M=1,MMAX
	P(L,M,1)=PT(M)/DEMP
	TEMP=TT(M)/DEM
	RO(L,M,l)=P(L,M,1)*GRGAS/TEMP
	Q=MN3*SQRT(GAMMA*P(L,M,1)/RO(L,M,1))
	DN=NXNYCB(L)+DNXNY*(M-1)
	DNS=DN*DN
	IF (DNS,EQ,0.O) GO TO 110
	SIGN=1.0
	IF (DN,GT,0.0) SIGN=-1.0
	U(L,M,1)=Q/SQRT(1.0+DNS)
	V(L,M,1)=SIGN*Q/SQRT(l.0+1.0/DNS)
	GO TO 120
	U(L,M,1)=Q
	V(L,M,1)=0.0
120	CONTINUE
130 CONTINUE
	RETURN
C
140 FORMAT (1H0,10X,93H***** THE l-D SOLUTION FOR THE INITIAL-DATA SUR
   1FACE FAILED TO CONVERGE IN 20 ITERATIONS AT L=,I2,6H *****)
	END